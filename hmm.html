<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HMM Regime Detection Explainer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.7;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 20px;
            color: #2c3e50;
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #2d3436 0%, #34495e 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        header p {
            font-size: 1.15em;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .content {
            padding: 50px 40px;
        }
        
        .section {
            margin-bottom: 45px;
            padding: 35px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 6px solid #2a5298;
        }
        
        .section h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 1.9em;
            font-weight: 600;
        }
        
        .section h3 {
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 18px;
            font-size: 1.5em;
            font-weight: 600;
        }
        
        .section h4 {
            color: #546e7a;
            margin-top: 20px;
            margin-bottom: 12px;
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .step {
            background: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #e0e0e0;
        }
        
        .step-number {
            display: inline-block;
            width: 38px;
            height: 38px;
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 38px;
            font-weight: 700;
            margin-right: 12px;
            font-size: 1.1em;
        }
        
        .formula {
            background: #e8eaf6;
            padding: 18px;
            border-radius: 6px;
            font-family: 'Courier New', Consolas, monospace;
            margin: 18px 0;
            overflow-x: auto;
            border-left: 4px solid #5c6bc0;
            font-size: 0.95em;
        }
        
        .example {
            background: #fff8e1;
            padding: 20px;
            border-radius: 6px;
            border-left: 4px solid #ffc107;
            margin: 18px 0;
        }
        
        .code {
            background: #263238;
            color: #aed581;
            padding: 22px;
            border-radius: 6px;
            font-family: 'Courier New', Consolas, monospace;
            overflow-x: auto;
            margin: 18px 0;
            font-size: 0.9em;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        
        .keyword {
            color: #ff6b6b;
        }
        
        .function {
            color: #4fc3f7;
        }
        
        .comment {
            color: #78909c;
        }
        
        .string {
            color: #ffd54f;
        }
        
        .highlight {
            background: #fff176;
            padding: 3px 6px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .info {
            background: #e3f2fd;
            padding: 18px;
            border-radius: 6px;
            border-left: 4px solid #2196f3;
            margin: 18px 0;
        }
        
        .success {
            background: #e8f5e9;
            padding: 18px;
            border-radius: 6px;
            border-left: 4px solid #4caf50;
            margin: 18px 0;
        }
        
        .warning {
            background: #fff3e0;
            padding: 18px;
            border-radius: 6px;
            border-left: 4px solid #ff9800;
            margin: 18px 0;
        }
        
        ul, ol {
            margin-left: 25px;
            margin-top: 12px;
        }
        
        li {
            margin: 10px 0;
        }
        
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .flow-box {
            background: white;
            padding: 20px 28px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #2a5298;
            min-width: 140px;
            text-align: center;
            font-size: 0.95em;
        }
        
        .arrow {
            font-size: 2.2em;
            color: #2a5298;
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: #f5f5f5;
        }

        pre {
            margin: 0;
            white-space: pre-wrap;
        }

        strong {
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ Hidden Markov Model Regime Detection</h1>
            <p>Deterministic Framework for Financial Time Series</p>
        </header>
        
        <div class="content">
            <!-- OVERVIEW -->
            <div class="section">
                <h2>üìã What This Does</h2>
                
                <p>This HMM framework automatically discovers <span class="highlight">hidden market regimes</span> in your time series data (like bull/bear/sideways markets) without you having to define them manually.</p>
                
                <div class="info">
                    <strong>Core Idea:</strong> Your data was generated by some underlying "state" (regime) that changes over time. The HMM learns what those states are and which state you're currently in.
                </div>
                
                <h3>Key Features of This Implementation</h3>
                <ul>
                    <li><strong>Deterministic:</strong> Same input always gives same output (no random initialization)</li>
                    <li><strong>Numerically stable:</strong> Careful handling of covariance matrices to avoid crashes</li>
                    <li><strong>Automatic model selection:</strong> Uses BIC to pick the optimal number of regimes</li>
                    <li><strong>Returns current regime:</strong> Tells you which state the market is in right now</li>
                </ul>
            </div>
            
            <!-- HOW IT WORKS -->
            <div class="section">
                <h2>‚öôÔ∏è How It Works: The Complete Process</h2>
                
                <div class="flow-diagram">
                    <div class="flow-box" style="background: #e3f2fd;">
                        <strong>Clean Data</strong><br/>
                        Remove NaN/inf
                    </div>
                    <span class="arrow">‚Üí</span>
                    <div class="flow-box" style="background: #f3e5f5;">
                        <strong>Test n=2,3,4,5...</strong><br/>
                        Try different regime counts
                    </div>
                    <span class="arrow">‚Üí</span>
                    <div class="flow-box" style="background: #fff3e0;">
                        <strong>Deterministic Init</strong><br/>
                        Set starting parameters
                    </div>
                    <span class="arrow">‚Üí</span>
                    <div class="flow-box" style="background: #e8f5e9;">
                        <strong>EM Algorithm</strong><br/>
                        Fit the model
                    </div>
                    <span class="arrow">‚Üí</span>
                    <div class="flow-box" style="background: #fce4ec;">
                        <strong>Calculate BIC</strong><br/>
                        Score the model
                    </div>
                    <span class="arrow">‚Üí</span>
                    <div class="flow-box" style="background: #c8e6c9;">
                        <strong>Pick Best</strong><br/>
                        Lowest BIC wins
                    </div>
                </div>
            </div>
            
            <!-- STEP 1: DATA PREPARATION -->
            <div class="section">
                <h2>üßπ Step 1: Data Preparation</h2>
                
                <div class="step">
                    <p><span class="step-number">1</span> <strong>Clean and shape the time series</strong></p>
                    
                    <p>The <code>_prepare_series()</code> function:</p>
                    <ul>
                        <li>Converts input to a 2D NumPy array (n_samples, n_features)</li>
                        <li>Removes any rows containing NaN or infinity values</li>
                        <li>Raises an error if all data is invalid</li>
                    </ul>
                    
                    <div class="code">
<span class="keyword">def</span> <span class="function">_prepare_series</span>(time_series):
    series = np.<span class="function">asarray</span>(time_series, dtype=<span class="keyword">float</span>)
    
    <span class="keyword">if</span> series.ndim == <span class="string">1</span>:
        series = series.<span class="function">reshape</span>(-<span class="string">1</span>, <span class="string">1</span>)
    
    <span class="comment"># Drop rows with any NaN or inf</span>
    mask = np.<span class="function">isfinite</span>(series).<span class="function">all</span>(axis=<span class="string">1</span>)
    clean = series[mask]
    
    <span class="keyword">return</span> clean
                    </div>
                    
                    <div class="example">
                        <strong>Example:</strong><br/>
                        Input: [0.82, NaN, 0.85, inf, 0.45]<br/>
                        Output: [[0.82], [0.85], [0.45]] (shape: 3√ó1)
                    </div>
                </div>
            </div>
            
            <!-- STEP 2: INITIALIZATION -->
            <div class="section">
                <h2>üé≤ Step 2: Deterministic Initialization</h2>
                
                <p>Unlike typical HMM implementations that use random initialization, this code uses <span class="highlight">deterministic, data-driven initialization</span> for reproducibility.</p>
                
                <div class="step">
                    <p><span class="step-number">2</span> <strong>Initialize HMM parameters intelligently</strong></p>
                    
                    <h4>Parameter: Means (Œº)</h4>
                    <p>Set based on <strong>quantiles</strong> of the data:</p>
                    
                    <div class="formula">
For n regimes, use quantiles at positions: [1/(n+1), 2/(n+1), ..., n/(n+1)]
                    </div>
                    
                    <div class="example">
                        <strong>Example with 3 regimes:</strong><br/>
                        Data: [0.45, 0.48, 0.65, 0.82, 0.85]<br/>
                        Quantiles: [25%, 50%, 75%]<br/>
                        <ul>
                            <li>Œº_LOW = Q25 = 0.48</li>
                            <li>Œº_MED = Q50 = 0.65</li>
                            <li>Œº_HIGH = Q75 = 0.82</li>
                        </ul>
                        Plus tiny jitter (1e-8 √ó regime_index) to break symmetry
                    </div>
                    
                    <h4>Parameter: Covariances (Œ£)</h4>
                    <p>All regimes start with the <strong>same base covariance</strong>:</p>
                    
                    <ul>
                        <li>1D data: Use variance of entire dataset</li>
                        <li>Multivariate data: Use full covariance matrix of dataset</li>
                        <li>Add diagonal jitter until matrix is positive definite (SPD)</li>
                    </ul>
                    
                    <div class="code">
<span class="comment"># 1D case</span>
base_var = np.<span class="function">var</span>(series)
covars = np.<span class="function">full</span>((n_components, <span class="string">1</span>, <span class="string">1</span>), base_var)

<span class="comment"># Multivariate case</span>
base_cov = np.<span class="function">cov</span>(series.T)
<span class="comment"># Test Cholesky decomposition, add jitter if needed</span>
covars = np.<span class="function">repeat</span>(base_cov[None, :, :], n_components, axis=<span class="string">0</span>)
                    </div>
                    
                    <h4>Parameter: Start Probabilities (œÄ)</h4>
                    <p><strong>Uniform distribution</strong> across all regimes:</p>
                    
                    <div class="formula">
œÄ = [1/n, 1/n, ..., 1/n]
                    </div>
                    
                    <div class="example">
                        For 3 regimes: œÄ = [0.333, 0.333, 0.333]
                    </div>
                    
                    <h4>Parameter: Transition Matrix (A)</h4>
                    <p><strong>Diagonal bias</strong> - strong preference for staying in current state:</p>
                    
                    <div class="formula">
A[i,i] = 0.80  (80% chance of staying)
A[i,j] = 0.20/(n-1)  for i‚â†j  (20% split among other states)
                    </div>
                    
                    <div class="example">
                        <strong>For 3 regimes:</strong>
                        <pre>
     LOW   MED   HIGH
LOW  [0.80  0.10  0.10]
MED  [0.10  0.80  0.10]
HIGH [0.10  0.10  0.80]
                        </pre>
                    </div>
                </div>
                
                <div class="info">
                    <strong>Why Deterministic?</strong> Random initialization can lead to different results each run, making it hard to debug and reproduce. This approach always starts from the same sensible place based on the actual data distribution.
                </div>
            </div>
            
            <!-- STEP 3: EM ALGORITHM -->
            <div class="section">
                <h2>üîÑ Step 3: The EM Algorithm</h2>
                
                <p>After initialization, the <span class="highlight">Expectation-Maximization (EM)</span> algorithm refines the parameters iteratively.</p>
                
                <h3>What Happens Inside <code>model.fit()</code></h3>
                
                <div class="step">
                    <h4>E-Step (Expectation)</h4>
                    <p>Given current parameters, calculate the <strong>probability that each time point belongs to each regime</strong>.</p>
                    
                    <div class="formula">
P(regime_k | value_t) = [P(value_t | regime_k) √ó P(regime_k)] / Œ£_all_regimes
                    </div>
                    
                    <p>Where:</p>
                    <ul>
                        <li><code>P(value_t | regime_k)</code> = Gaussian probability density with regime k's Œº and œÉ¬≤</li>
                        <li><code>P(regime_k)</code> = Based on transition probabilities and previous state</li>
                    </ul>
                    
                    <div class="example">
                        <strong>Example calculation at time t:</strong><br/>
                        Value: 0.82<br/>
                        Current parameters: Œº_HIGH=0.80, œÉ¬≤_HIGH=0.01, Œº_MED=0.65, œÉ¬≤_MED=0.02<br/>
                        <br/>
                        Calculate Gaussian densities:<br/>
                        <ul>
                            <li>P(0.82 | HIGH) = 3.90 (high probability, close to Œº_HIGH)</li>
                            <li>P(0.82 | MED) = 1.38 (lower, farther from Œº_MED)</li>
                            <li>P(0.82 | LOW) = 0.004 (very low)</li>
                        </ul>
                        <br/>
                        After normalization:<br/>
                        <ul>
                            <li>P(HIGH | 0.82) = <strong>74%</strong></li>
                            <li>P(MED | 0.82) = <strong>26%</strong></li>
                            <li>P(LOW | 0.82) = <strong>0.1%</strong></li>
                        </ul>
                    </div>
                </div>
                
                <div class="step">
                    <h4>M-Step (Maximization)</h4>
                    <p>Using the probabilities from E-step, <strong>update all parameters</strong> to maximize likelihood.</p>
                    
                    <div class="formula">
Œº_k = Œ£[value_t √ó P(regime_k | value_t)] / Œ£[P(regime_k | value_t)]

œÉ¬≤_k = Œ£[(value_t - Œº_k)¬≤ √ó P(regime_k | value_t)] / Œ£[P(regime_k | value_t)]
                    </div>
                    
                    <div class="example">
                        <strong>Update Œº_HIGH using 5 values:</strong>
                        <pre>
Time 0 (0.82): 40% HIGH ‚Üí contributes 0.82 √ó 0.40 = 0.328
Time 1 (0.85): 50% HIGH ‚Üí contributes 0.85 √ó 0.50 = 0.425
Time 2 (0.45): 10% HIGH ‚Üí contributes 0.45 √ó 0.10 = 0.045
Time 3 (0.48): 20% HIGH ‚Üí contributes 0.48 √ó 0.20 = 0.096
Time 4 (0.81): 60% HIGH ‚Üí contributes 0.81 √ó 0.60 = 0.486

Sum of contributions: 1.38
Sum of probabilities: 1.80

Œº_HIGH_new = 1.38 / 1.80 = <strong>0.767</strong>
                        </pre>
                    </div>
                    
                    <p>Transition probabilities are also updated based on observed regime-to-regime transitions.</p>
                </div>
                
                <div class="step">
                    <h4>Convergence</h4>
                    <p>Repeat E-step and M-step until:</p>
                    <ul>
                        <li>Log-likelihood stops improving (change < threshold)</li>
                        <li>Parameters stabilize</li>
                        <li>Maximum iterations reached</li>
                    </ul>
                    
                    <div class="success">
                        ‚úÖ After convergence (~10-100 iterations), you have learned:
                        <ul>
                            <li>Optimal Œº and Œ£ for each regime</li>
                            <li>Realistic transition probabilities</li>
                            <li>Clear regime assignments (e.g., 98% confidence time point is in regime 2)</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- STEP 4: MODEL SELECTION -->
            <div class="section">
                <h2>üìä Step 4: Model Selection with BIC</h2>
                
                <p>How many regimes should we use? 2? 3? 10? The code tries multiple values and picks the best using <span class="highlight">BIC (Bayesian Information Criterion)</span>.</p>
                
                <div class="formula">
BIC = -2 √ó log_likelihood + n_params √ó log(n_samples)
                </div>
                
                <h3>Understanding the Two Parts</h3>
                
                <table>
                    <tr>
                        <th>Component</th>
                        <th>What It Measures</th>
                        <th>Effect on BIC</th>
                    </tr>
                    <tr>
                        <td><strong>-2 √ó log_likelihood</strong></td>
                        <td>How poorly the model fits the data</td>
                        <td>More regimes ‚Üí better fit ‚Üí LOWER</td>
                    </tr>
                    <tr>
                        <td><strong>n_params √ó log(n_samples)</strong></td>
                        <td>Complexity penalty</td>
                        <td>More regimes ‚Üí more params ‚Üí HIGHER</td>
                    </tr>
                </table>
                
                <div class="info">
                    <strong>The Trade-off:</strong> Adding more regimes improves fit (good) but increases complexity (bad). BIC finds the sweet spot.
                </div>
                
                <h3>Parameter Counting</h3>
                
                <p>For a Gaussian HMM with <code>n</code> regimes and <code>d</code> features:</p>
                
                <div class="formula">
n_params = (n-1) + n(n-1) + n√ód + n√ód(d+1)/2

Where:
  (n-1)        = start probabilities
  n(n-1)       = transition matrix
  n√ód          = means
  n√ód(d+1)/2   = covariances (full matrices)
                </div>
                
                <div class="example">
                    <strong>Example: 1D data, comparing different regime counts</strong>
                    <pre>
n=2: n_params=7,  BIC=152  (too simple, underfits)
n=3: n_params=15, BIC=128  ‚úÖ <strong>BEST! Lowest BIC</strong>
n=4: n_params=26, BIC=138  (unnecessary complexity)
n=5: n_params=40, BIC=151  (definitely overfitting)
                    </pre>
                    
                    The code selects <strong>n=3</strong> as optimal.
                </div>
                
                <div class="code">
<span class="comment"># From the code</span>
<span class="keyword">for</span> n <span class="keyword">in</span> <span class="function">range</span>(min_regimes, max_regimes + <span class="string">1</span>):
    model = <span class="function">GaussianHMM</span>(n_components=n, **params)
    <span class="function">_safe_deterministic_init</span>(model, series)
    model.<span class="function">fit</span>(series)
    
    logL = model.<span class="function">score</span>(series) * n_samples
    n_params = <span class="function">_num_hmm_params</span>(n, n_features)
    bic = -<span class="string">2.0</span> * logL + n_params * np.<span class="function">log</span>(n_samples)
    
    bic_scores.<span class="function">append</span>(bic)
    models.<span class="function">append</span>(model)

best_idx = np.<span class="function">argmin</span>(bic_scores)  <span class="comment"># Pick lowest BIC</span>
                </div>
            </div>
            
            <!-- STEP 5: REGIME DETECTION -->
            <div class="section">
                <h2>üéØ Step 5: Detect Current Regime</h2>
                
                <p>Once the best model is selected, use it to identify which regime each time point belongs to.</p>
                
                <div class="step">
                    <p><span class="step-number">5</span> <strong>Get regime probabilities and assignments</strong></p>
                    
                    <div class="code">
<span class="comment"># Get probability distribution for all time points</span>
all_probs = best_model.<span class="function">predict_proba</span>(series)
<span class="comment"># Shape: (n_samples, n_regimes)</span>
<span class="comment"># Example: [[0.95, 0.03, 0.02],  ‚Üê time 0</span>
<span class="comment">#           [0.97, 0.02, 0.01],  ‚Üê time 1</span>
<span class="comment">#           [0.08, 0.89, 0.03],  ‚Üê time 2</span>
<span class="comment">#           ...]</span>

<span class="comment"># Hard assignments: pick most likely regime</span>
regimes = np.<span class="function">argmax</span>(all_probs, axis=<span class="string">1</span>)
<span class="comment"># Example: [0, 0, 1, 1, 1, 2, 2, ...]</span>

<span class="comment"># Current regime is the last value</span>
current_regime = regimes[-<span class="string">1</span>]
                    </div>
                    
                    <div class="info">
                        <strong>Important:</strong> The <code>predict_proba()</code> method uses the <strong>forward algorithm</strong>, which is causal (no look-ahead). It only uses information up to that time point, making it suitable for real-time trading.
                    </div>
                    
                    <div class="example">
                        <strong>Example output:</strong><br/>
                        Time series: [0.82, 0.85, 0.83, 0.48, 0.45, 0.81]<br/>
                        Detected regimes: [HIGH, HIGH, HIGH, LOW, LOW, HIGH]<br/>
                        Current regime: <strong>HIGH</strong> (regime index 2)
                    </div>
                </div>
            </div>
            
            <!-- PRACTICAL USAGE -->
            <div class="section">
                <h2>üíº Practical Usage</h2>
                
                <h3>How to Call the Function</h3>
                
                <div class="code">
<span class="keyword">from</span> hidden_markov_model <span class="keyword">import</span> get_regime

<span class="comment"># Your time series data (e.g., rolling sharpe ratios, returns, etc.)</span>
time_series = [<span class="string">0.82</span>, <span class="string">0.85</span>, <span class="string">0.83</span>, <span class="string">0.48</span>, <span class="string">0.45</span>, <span class="string">0.46</span>, <span class="string">0.81</span>]

<span class="comment"># Get current regime (tests 2-6 regimes by default)</span>
current_regime = <span class="function">get_regime</span>(
    time_series=time_series,
    min_regimes=<span class="string">2</span>,
    max_regimes=<span class="string">6</span>,
    hmm_kwargs={<span class="string">'n_iter'</span>: <span class="string">100</span>}  <span class="comment"># optional overrides</span>
)

<span class="function">print</span>(<span class="string">f"Current market regime: {current_regime}"</span>)
<span class="comment"># Output: Current market regime: 2 (meaning HIGH if 3 regimes)</span>
                </div>
                
                <h3>Common Use Cases</h3>
                
                <ul>
                    <li><strong>Regime-aware trading:</strong> Use different strategies in bull vs bear regimes</li>
                    <li><strong>Risk management:</strong> Reduce position sizes in high-volatility regimes</li>
                    <li><strong>Feature engineering:</strong> Use regime as an input to other models</li>
                    <li><strong>Market analysis:</strong> Identify structural breaks and regime shifts</li>
                </ul>
                
                <div class="warning">
                    <strong>‚ö†Ô∏è Lookback Considerations:</strong><br/>
                    The regime detection is based on historical data up to the current point. Make sure your time series has enough history (recommended: 100+ points) for stable regime identification.
                </div>
            </div>
            
            <!-- KEY ADVANTAGES -->
            <div class="section">
                <h2>‚ú® Key Advantages of This Implementation</h2>
                
                <table>
                    <tr>
                        <th>Feature</th>
                        <th>Benefit</th>
                    </tr>
                    <tr>
                        <td><strong>Deterministic Init</strong></td>
                        <td>Same data ‚Üí same results every time (reproducible)</td>
                    </tr>
                    <tr>
                        <td><strong>Quantile-Based Means</strong></td>
                        <td>Initialization reflects actual data distribution</td>
                    </tr>
                    <tr>
                        <td><strong>SPD Covariance Handling</strong></td>
                        <td>Numerically stable, avoids linear algebra errors</td>
                    </tr>
                    <tr>
                        <td><strong>Automatic BIC Selection</strong></td>
                        <td>Finds optimal complexity without manual tuning</td>
                    </tr>
                    <tr>
                        <td><strong>Causal Detection</strong></td>
                        <td>Forward algorithm = no future peeking, suitable for live trading</td>
                    </tr>
                    <tr>
                        <td><strong>Clean Error Handling</strong></td>
                        <td>Gracefully handles NaN/inf, warns about data quality</td>
                    </tr>
                </table>
            </div>
            
            <!-- SUMMARY -->
            <div class="section">
                <h2>üéì Summary</h2>
                
                <div class="success">
                    <strong>What You've Learned:</strong>
                    <ul>
                        <li>HMMs discover <span class="highlight">hidden market states</span> from observable data</li>
                        <li>The EM algorithm <span class="highlight">alternates between calculating probabilities and updating parameters</span> until convergence</li>
                        <li>BIC balances <span class="highlight">model fit vs complexity</span> to prevent overfitting</li>
                        <li>Deterministic initialization makes results <span class="highlight">reproducible and data-driven</span></li>
                        <li>The forward algorithm enables <span class="highlight">causal, real-time regime detection</span></li>
                    </ul>
                </div>
                
                <div class="info">
                    <strong>üöÄ Next Steps:</strong>
                    <ul>
                        <li>Test on your own time series data (returns, volatility, technical indicators)</li>
                        <li>Experiment with different <code>min_regimes</code> and <code>max_regimes</code> ranges</li>
                        <li>Combine regime information with your existing trading strategies</li>
                        <li>Monitor regime transitions as potential trading signals</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
