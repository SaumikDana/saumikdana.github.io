<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Options Trading System Architecture: From Monolithic to Modular</title>
    <style>
        body {
            font-family: 'Georgia', serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            line-height: 1.6;
            color: #333;
            background-color: #fafafa;
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        h2 {
            color: #34495e;
            margin-top: 40px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            font-size: 1.8em;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.4em;
        }
        
        h4 {
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 12px;
            font-size: 1.2em;
            font-weight: 600;
        }
        
        code {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 2px 6px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: #d73502;
        }
        
        ul {
            margin: 10px 0;
            padding-left: 25px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #ddd;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid #ddd;
            vertical-align: top;
            color: #333;
        }
        
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        
        td {
            text-align: center;
            background-color: white;
            color: #333;
            font-weight: normal;
        }
        
        td:first-child {
            text-align: left;
            font-weight: bold;
            background-color: #f8f9fa;
            color: #2c3e50;
        }
        
        tbody tr:nth-child(even) td {
            background-color: #f9f9f9;
            color: #333;
        }
        
        tbody tr:nth-child(even) td:first-child {
            background-color: #f0f0f0;
            color: #2c3e50;
        }
        
        .layer-box {
            background-color: white;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .module-box {
            background-color: #f8f9fa;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 4px 4px 0;
        }
        
        .stats-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .stats-container h2 {
            color: white;
            border-left: 4px solid white;
            margin-top: 0;
        }
        
        caption {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .intro-section {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        
        .conclusion-section {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
        }
        
        .conclusion-section h2 {
            color: white;
            border-left: 4px solid white;
        }
    /* Enhanced Navigation Styles */
    nav {
        background: linear-gradient(135deg, #667eea, #764ba2);
        border-radius: 20px;
        padding: 25px 35px;
        margin: 30px 0;
        text-align: center;
        box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
        position: relative;
        overflow: hidden;
    }

    nav::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        animation: navShimmer 3s ease-in-out infinite;
    }

    @keyframes navShimmer {
        0%, 100% { left: -100%; }
        50% { left: 100%; }
    }

    nav .tablinks {
        display: inline-block;
        background: rgba(255, 255, 255, 0.2);
        color: white;
        text-decoration: none;
        padding: 15px 35px;
        margin: 0 15px;
        border-radius: 25px;
        font-weight: 600;
        font-size: 1.1rem;
        transition: all 0.3s ease;
        position: relative;
        z-index: 1;
        border: 2px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
    }

    nav .tablinks::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.3));
        border-radius: 25px;
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    nav .tablinks:hover::before {
        opacity: 1;
    }

    nav .tablinks:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        background: rgba(255, 255, 255, 0.3);
        border-color: rgba(255, 255, 255, 0.5);
    }

    nav .tablinks:active {
        transform: translateY(-1px) scale(1.02);
    }

    @media (max-width: 768px) {
        .header h1 { font-size: 2.2rem; }
        .header p { font-size: 1.1rem; }
        .content { padding: 30px 25px; }
        .section-title { font-size: 1.7rem; }
        .improvements-grid { grid-template-columns: 1fr; }
        .problems-grid { grid-template-columns: 1fr; }
        
        nav {
            padding: 20px;
        }
        
        nav .tablinks {
            display: block;
            margin: 10px 0;
            padding: 12px 25px;
            font-size: 1rem;
        }
    }
    </style>
</head>
<body>
    <h1>Options Trading System Architecture: From Monolithic to Modular</h1>

    <nav>
    <a href="improv.html" class="tablinks">Speed & Efficiency</a>
    <a href="overall.html" class="tablinks">Workflow</a>
    </nav>
    
    <div class="intro-section">
        <h2>Architectural Transformation</h2>
        
        <p>The inherited codebase consisted of two primary files:</p>
        <ul>
            <li><code>option_trading_saumik.py</code> (910 lines): Monolithic trading script</li>
            <li><code>myfunctions.py</code> (135 lines): Basic utility functions</li>
        </ul>
        
        <p>The original system exhibited typical characteristics of research-to-production code with mixed concerns, hardcoded parameters, and limited extensibility.</p>
    </div>

    <div class="stats-container">
        <h2>System Transformation Metrics</h2>
        <table>
            <caption>Comprehensive comparison of system architectures</caption>
            <thead>
                <tr>
                    <th>Aspect</th>
                    <th>Original Monolithic</th>
                    <th>Refactored Modular</th>
                    <th>Improvement</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Total Lines of Code</td>
                    <td>1,045</td>
                    <td>2,876</td>
                    <td>2.75x expansion</td>
                </tr>
                <tr>
                    <td>Number of Files</td>
                    <td>2</td>
                    <td>18</td>
                    <td>9x modularity</td>
                </tr>
                <tr>
                    <td>Architectural Layers</td>
                    <td>1</td>
                    <td>8</td>
                    <td>8x separation</td>
                </tr>
                <tr>
                    <td>Strategy Types Supported</td>
                    <td>1</td>
                    <td>3</td>
                    <td>Calendar, Signal, Release</td>
                </tr>
                <tr>
                    <td>P&L Components</td>
                    <td>Mixed</td>
                    <td>4 Separated</td>
                    <td>Init, Exist, Exit, Expiry</td>
                </tr>
                <tr>
                    <td>Position Sizing Methods</td>
                    <td>4</td>
                    <td>4</td>
                    <td>Enhanced with IV adjustments</td>
                </tr>
                <tr>
                    <td>Performance Optimization</td>
                    <td>None</td>
                    <td>Systematic</td>
                    <td>Profiling & Caching</td>
                </tr>
                <tr>
                    <td>Economic Indicators</td>
                    <td>None</td>
                    <td>50+</td>
                    <td>Fed, Inflation, Employment</td>
                </tr>
                <tr>
                    <td>Maintainability</td>
                    <td>Monolithic</td>
                    <td>Modular</td>
                    <td>Independent Testing</td>
                </tr>
                <tr>
                    <td>Error Handling</td>
                    <td>Basic</td>
                    <td>Comprehensive</td>
                    <td>Layer-Specific Validation</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="layer-box">
        <h3>Layer 1: Data Architecture Redesign (4 modules)</h3>
        
        <div class="module-box">
            <h4><code>data_processing.py</code></h4>
            <p>Core data pipeline engine handling:</p>
            <ul>
                <li>Options chain processing via <code>csv_to_pandas()</code></li>
                <li>Holiday-aware business day calculations</li>
                <li>Complex expiration rules (Friday/Saturday/holiday scenarios)</li>
                <li>Bloomberg pricing integration through <code>merge_bbg()</code></li>
                <li>Moneyness calculations for contract selection</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>csv_to_pandas.py</code></h4>
            <p>Data orchestration hub providing three entry points:</p>
            <ul>
                <li><code>main()</code>: Standard strategy coordination</li>
                <li><code>main_releases()</code>: Event-driven strategy preparation</li>
                <li><code>main_monthly()</code>: Monthly expiration focus</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>monthly_expiry_trade_setup.py</code></h4>
            <p>Specialized monthly expiration processor:</p>
            <ul>
                <li><code>third_entry_per_month()</code>: Third Friday extraction</li>
                <li>Market convention compliance for high-liquidity contracts</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>release_based_trade_setup.py</code></h4>
            <p>Economic event processor featuring:</p>
            <ul>
                <li>Comprehensive indicator mapping (CPI, NFP, FOMC)</li>
                <li>Regex pattern matching for event identification</li>
                <li><code>find_nearest_expiration_dates()</code>: Release-to-expiration mapping</li>
            </ul>
        </div>
    </div>

    <div class="layer-box">
        <h3>Layer 2: Strategy Abstraction Layer (3 modules)</h3>
        
        <div class="module-box">
            <h4><code>config_entry_around_release.py</code></h4>
            <p>Event-driven strategy engine:</p>
            <ul>
                <li>Sophisticated backward date calculation in <code>fill_entry_days()</code></li>
                <li>Consistent timing relative to economic announcements</li>
                <li>Monte Carlo optimization with intelligent caching</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>config_entry_on_day_and_sig.py</code></h4>
            <p>Calendar-based strategy processor:</p>
            <ul>
                <li>DataFrame index arithmetic for business day precision</li>
                <li>Custom entry/exit condition support</li>
                <li>Systematic calendar scheduling maintenance</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>config_entry_on_sig.py</code></h4>
            <p>Signal-based reactive strategy engine:</p>
            <ul>
                <li>Market condition responsiveness</li>
                <li>Direct simulation without preprocessing</li>
                <li>Irregular timing accommodation</li>
            </ul>
        </div>
    </div>

    <div class="layer-box">
        <h3>Layer 3: Financial Calculation Engine (2 modules)</h3>
        
        <div class="module-box">
            <h4><code>pnl_computor.py</code></h4>
            <p>Comprehensive P&L calculation engine with component separation:</p>
            <ul>
                <li><code>pnl_init()</code>: Transaction cost calculation</li>
                <li><code>pnl_exist()</code>: Mark-to-market computation</li>
                <li><code>pnl_exit()</code>: Early close cost assessment</li>
                <li><code>pnl_expiry()</code>: Intrinsic value settlement</li>
                <li><code>zero_out_pnl()</code>: Corporate action handling</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>delta_hedger.py</code></h4>
            <p>Delta-neutral hedging implementation:</p>
            <ul>
                <li><code>calculate_hedges_single_cycle()</code>: Per-cycle hedge P&L</li>
                <li>Previous day delta exposure utilization</li>
                <li>Target delta management</li>
                <li>Initiation/expiration day special handling</li>
            </ul>
        </div>
    </div>

    <div class="layer-box">
        <h3>Layer 4: Modular Option Selection System (2 modules)</h3>
        
        <div class="module-box">
            <h4><code>option_selector.py</code></h4>
            <p>Contract selection orchestration:</p>
            <ul>
                <li><code>day_based_selector()</code>: Calendar strategy selection</li>
                <li><code>signal_based_selector()</code>: Reactive strategy selection</li>
                <li><code>release_based_selector()</code>: Event-driven selection</li>
                <li>Strategy-specific timing and validation</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>option_selector_routines.py</code></h4>
            <p>Selection utility functions:</p>
            <ul>
                <li><code>get_selected_option()</code>: Delta/moneyness targeting</li>
                <li><code>options_selections()</code>: Comprehensive trade record generation</li>
                <li><code>get_curtailed_options()</code>: Performance-optimized filtering</li>
                <li><code>trading_days_count()</code>: Business day arithmetic</li>
            </ul>
        </div>
    </div>

    <div class="layer-box">
        <h3>Layer 5: Performance Optimization Framework (1 module)</h3>
        
        <div class="module-box">
            <h4><code>profiling.py</code></h4>
            <p>Performance monitoring and optimization system:</p>
            <ul>
                <li><code>start_profiler()</code>/<code>end_profiler()</code>: Code analysis tools</li>
                <li>Multiple filtering function versions (<code>filter_v1</code> through <code>filter_v4</code>)</li>
                <li>Lookup optimization evolution (<code>lookup_v1</code> through <code>lookup_v3</code>)</li>
                <li>Visual performance graph generation</li>
            </ul>
        </div>
    </div>

    <div class="layer-box">
        <h3>Layer 6: Signal Processing Abstraction (1 module)</h3>
        
        <div class="module-box">
            <h4><code>sigdata.py</code></h4>
            <p>Signal state machine implementation:</p>
            <ul>
                <li><code>get_list_newsig_cycle()</code>: Entry/exit state management</li>
                <li>Duplicate entry prevention during continuous signals</li>
                <li><code>create_exit_on_day()</code>: Fixed holding period exits</li>
                <li><code>create_exit_around_release()</code>: Event-based exit timing</li>
            </ul>
        </div>
    </div>

    <div class="layer-box">
        <h3>Layer 7: Position Management System (3 modules)</h3>
        
        <div class="module-box">
            <h4><code>option_feeder.py</code></h4>
            <p>Trade execution engine:</p>
            <ul>
                <li><code>feed_trades_into_dict_options()</code>: Signal-to-position conversion</li>
                <li><code>fill_why_tradetype_nopnl()</code>: Exit logic and P&L period management</li>
                <li>Re-entry processing for rolling strategies</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>option_strategy_simulator.py</code></h4>
            <p>Central orchestration hub:</p>
            <ul>
                <li><code>initial_setup()</code>: System initialization</li>
                <li><code>compute_pnl()</code>: P&L calculation coordination</li>
                <li><code>compute_performance()</code>: Performance analysis orchestration</li>
                <li>Multi-cycle organization management</li>
                <li>Custom condition filtering integration</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>position_sizing.py</code></h4>
            <p>Capital allocation logic:</p>
            <ul>
                <li>Multiple sizing methodologies: AUM-based, vega budgeting, premium budgeting</li>
                <li><code>iv_size_mult()</code>: Volatility-based size adjustments</li>
                <li>Risk management through position scaling</li>
            </ul>
        </div>
    </div>

    <div class="layer-box">
        <h3>Layer 8: Analysis and Reporting Layer (2 modules)</h3>
        
        <div class="module-box">
            <h4><code>performance_metrics.py</code></h4>
            <p>Risk-adjusted performance analysis:</p>
            <ul>
                <li>Comprehensive metrics: Sharpe/Sortino ratios, drawdown analysis</li>
                <li>Correlation and beta calculations</li>
                <li>Geometric and arithmetic return methodologies</li>
                <li>Benchmark comparison framework</li>
            </ul>
        </div>

        <div class="module-box">
            <h4><code>pnl_analyzer.py</code></h4>
            <p>P&L attribution and breakdown:</p>
            <ul>
                <li><code>calculate_pnl_sums()</code>: Trade-level summaries</li>
                <li>Cycle-based performance analysis</li>
                <li>Comprehensive P&L aggregation across strategy components</li>
                <li>Attribution analysis for performance optimization</li>
            </ul>
        </div>
    </div>

<!-- Image section outside the main container -->
<div style="text-align: center; padding: 40px 20px; background: #f8f9fa;">
    <img src="pandas.png" alt="Pandas" style="width: 80%; max-width: 1400px; border-radius: 8px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);">
</div>

<!-- Image section outside the main container -->
<div style="text-align: center; padding: 40px 20px; background: #f8f9fa;">
    <img src="pandas_fluency.png" alt="Pandas" style="width: 80%; max-width: 1400px; border-radius: 8px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);">
</div>
    
</body>
</html>
